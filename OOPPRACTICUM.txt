DROP TABLE IF EXISTS PERSON;
CREATE TABLE PERSON(
ID IDENTITY PRIMARY KEY, 
FNAME VARCHAR(20) NOT NULL, 
LNAME VARCHAR(20) NOT NULL,
GENDER CHAR(1) NOT NULL,
CHECK(GENDER='M' OR GENDER='F'),
AGE INT NOT NULL
);

DROP TABLE IF EXISTS BOOK;
CREATE TABLE BOOK(
ID IDENTITY PRIMARY KEY,
TITLE NVARCHAR(50) NOT NULL,
AUTHOR NVARCHAR(60) NOT NULL,
YEAR_OF_PUBLISHING INT NOT NULL,
PUBLISHER NVARCHAR(50) NOT NULL
);

DROP TABLE IF EXISTS RENT;
CREATE TABLE RENT(
ID IDENTITY PRIMARY KEY,
PERSON_ID INT NOT NULL,
BOOK_ID INT NOT NULL,
DATE_OF_RENT DATE NOT NULL,
DATE_OF_RETURN DATE NOT NULL,
FOREIGN KEY(PERSON_ID)
REFERENCES PERSON(ID)
ON DELETE CASCADE,
FOREIGN KEY(BOOK_ID)
REFERENCES BOOK(ID)
ON DELETE CASCADE
);

select person_id, fname, lname, age, title, author, date_of_rent, date_of_return from person p
join rent r
on p.id=r.person_id
join book b
on r.book_id=b.id;